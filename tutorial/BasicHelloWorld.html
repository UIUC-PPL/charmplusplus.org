<!DOCTYPE HTML>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta charset="utf-8">
    <title>Charm++: Tutorial</title>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<link href="../assets/charmwebsite.css" rel="stylesheet" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Puritan" rel="stylesheet" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Droid%20Sans" rel="stylesheet" type="text/css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript">
		</script>
    <script src="https://charm.cs.illinois.edu/codemirror/lib/codemirror.js" type="text/javascript">
		</script>
    <script src="https://charm.cs.illinois.edu/codemirror/mode/clike/clike.js" type="text/javascript">
		</script>
    <script src="https://charm.cs.illinois.edu/codemirror/lib/util/runmode.js" type="text/javascript">
		</script>
    <link href="https://charm.cs.illinois.edu/codemirror/lib/codemirror.css" rel="stylesheet" type="text/css">
    <link href="https://charm.cs.illinois.edu/codemirror/theme/lesser-dark.css" rel="stylesheet" type="text/css">
    <script src="../assets/prettify.js" type="text/javascript"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<!-- for equations from LaTeX to appear correctly-->
		<script type="text/javascript" src="https://latex.codecogs.com/latexit.js"></script>
		
    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 4.11.14"> 
  </head>

  <body>
    <div class="container">
 <nav class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
	  <!-- Brand and toggle get grouped for better mobile display -->
		<div id="logo"><a href="../"><img class="img-responsive" src="../images/charm_logo.jpg"></a></div>

<!-- Charm++ Button textformatted placeholder for logo button
		<div class="navbar-header">
	    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
	    </button>
	    <a class="navbar-brand" href="/"><b>Charm++</b></a>
	  </div>
-->

	  <!-- Collect the nav links, forms, and other content for toggling -->
	  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	    <ul class="nav navbar-nav">
              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Explore<span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="../capabilities/">Capabilities</a></li>
		  <li><a href="../progmodel/">Programming Model</a></li>
		  <li><a href="../execmodel/">Execution Model</a></li>
		  <li><a href="../applications/">Applications</a></li>
		  <li><a href="https://charm.cs.illinois.edu/papers/">Publications</a></li>
		  <li><a href="../history/">History</a></li>
		</ul>
              </li>
              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Learn <span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="https://charm.readthedocs.io/en/latest/charm++/manual.html#installing-charm">Installation</a></li>
      		  <li><a href="./">Tutorial</a></li>
						<li><a href="../exercises/">Exercises</a></li>
      		  <li><a href="../help/">Manual</a></li>
      		  <li><a href="../tools/">Tools</a></li>
      		  <li><a href="../othermedia/">Other Media</a></li>
		</ul>
              </li>

              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Follow <span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="https://github.com/UIUC-PPL/charm/commits/master">Recent Commits</a></li>
      	  <li><a href="https://github.com/UIUC-PPL/charm/issues">Issue Tracker</a></li>
      		  <li><a href="https://charm.cs.illinois.edu/autobuild/cur/">Nightly Tests</a></li>
      	  <li><a href="https://lists.cs.illinois.edu/lists/info/charm">Mailing Lists</a></li>
      		  <li><a href="https://charm.cs.illinois.edu/gerrit/#/admin/projects/">Other Repositories</a></li>
      		  <li><a href="https://charm.cs.illinois.edu">PPL Website</a></li>
		</ul>
              </li>

              <li class="dropdown">
		<a href="../download/">Downloads</a>
              </li>

              <li class="dropdown">
		<a href="../miniApps/">Mini-Apps</a>
              </li>

	    </ul>
	    <form class="navbar-form navbar-right" role="search" method="get" action="https://www.google.com/search">
              <div class="form-group">
		<input type="hidden" name="sitesearch" value="charmplusplus.org">
		<input type="text" class="form-control" name="q" placeholder="Search">
              </div>
              <button type="submit" class="btn btn-default">Submit</button>
	    </form>
	  </div>
<!-- /.navbar-collapse -->
	</div>
<!-- /.container-fluid -->
      </nav>


 <div id="maincontainer">
   <div id="content">
       <link rel="stylesheet" type="text/css" href="TutorialStyle.css">
  
  <h1>Basic "Hello World" Program</h1>  


  <p class="BasicParagraph">
   The figure below presents the code for the most basic "Hello World" program that
   can be written using Charm++.  The program only has a single chare object (the main chare
   object that is auto-generated by the Charm++ Runtime System).  The main chare object
   simply prints a "Hello World" message to standard output and then exits.
   The source code for this example can be downloaded
   <a href="examples/BasicHelloWorld.tar.gz">here (BasicHelloWorld.tar.gz)</a>.
   (Remember to set the CHARMDIR in the Makefile!)
  </p>
  
  <!-- Figure -->
   <table class="StandardFigure" border="0" cellspacing="0" cellpadding="5" align="right">

    <tr>
     <td align="center" valign="middle" bgcolor="bbbbbb"><b><u>Header File <i>(main.h)</i></u></b></td>
     <td align="center" valign="middle" bgcolor="cccccc"><b><u>Source File <i>(main.C)</i></u></b></td>
    </tr>

    <tr>

     <!-- Header File -->
     <td align="left" valign="top" bgcolor="bbbbbb">
      <div class="code">
       <code>
        #ifndef __MAIN_H__<br>
        #define __MAIN_H__<br>
        <br>
        class Main : public CBase_Main { <font class="generalComment">(1)</font><br>
        <br>
         public:<br>
          Main(CkArgMsg* msg); <font class="generalComment">(2)</font><br>
          Main(CkMigrateMessage* msg); <font class="generalComment">(3)</font><br>
        <br>
        };<br>
        <br>
        #endif <font class="codeComment">//__MAIN_H__</font>
       </code>
      </div>
     </td>

     <!-- Source File -->
     <td align="left" valign="top" bgcolor="cccccc">
      <div class="code">
       <code>
        #include "main.decl.h"  <font class="generalComment">(6)</font><br>
        #include "main.h"<br>
        <br>
        <font class="codeComment">// Entry point of Charm++ application</font><br>
        Main::Main(CkArgMsg* msg) {<br>
        <br>
          <font class="codeComment">// Print a message for the user</font><br>
          CkPrintf("Hello World!\n");  <font class="generalComment">(4)</font><br>
        <br>
          <font class="codeComment">// Exit the application</font>  <font class="generalComment">(5)</font><br>
          CkExit();<br>
        }<br>
        <br>
        <font class="codeComment">// Constructor needed for chare object migration (ignore</font><br>
        <font class="codeComment">//   for now)  NOTE: This constructor does not need to</font><br>
        <font class="codeComment">//   appear in the ".ci" file</font><br>
        Main::Main(CkMigrateMessage* msg) { }<br>
        <br>
        #include "main.def.h"  <font class="generalComment">(6)</font>
       </code>
      </div>
     </td>
     
    </tr>

    <tr>
     <td align="center" valign="middle" bgcolor="cccccc"><b><u>Interface File <i>(main.ci)</i></u></b></td>
     <td align="center" valign="middle" bgcolor="bbbbbb"><b><u>Makefile</u></b></td>
    </tr>

    <tr>

     <!-- Interface File -->
     <td align="left" valign="top" bgcolor="cccccc">
      <div class="code">
       <code>
        mainmodule main {  <font class="generalComment">(7)</font><br>
        <br>
          mainchare Main {  <font class="generalComment">(8)</font><br>
            entry Main(CkArgMsg* msg);  <font class="generalComment">(9)</font><br>
          };<br>
        <br>
        };
       </code>
      </div>
     </td>

     <!-- Makefile -->
     <td align="left" valign="top" bgcolor="bbbbbb">
      <div class="code">
       <code>
        CHARMDIR = <font class="generalComment">[put Charm++ install directory here]</font>  <font class="generalComment">(10)</font><br>
        CHARMC = $(CHARMDIR)/bin/charmc $(OPTS)  <font class="generalComment">(11)</font><br>
        <br>
        default: all<br>
        all: hello<br>
        <br>
        hello : main.o<br>
           $(CHARMC) -language charm++ -o hello main.o  <font class="generalComment">(12)</font><br>
        <br>
        main.o : main.C main.h main.decl.h main.def.h<br>
           $(CHARMC) -o main.o main.C  <font class="generalComment">(13)</font><br>
        <br>
        main.decl.h main.def.h : main.ci<br>
           $(CHARMC) main.ci  <font class="generalComment">(14)</font><br>
        <br>
        clean:<br>
           rm -f main.decl.h main.def.h main.o hello charmrun
       </code>
      </div>
     </td>

    </tr>
    
    <tr>
     <td colspan="2" align="center" valign="middle">
      <b>Figure 1:</b> Source code and Makefile for Basic "Hello World" Program
     </td>
    </tr>
    
   </table>
  
  
  <h3>The Header File <i>(main.h)</i>
</h3>
  
  <p class="BasicParagraph">
   The header file for a chare class in Charm++ is basically the same as it would be
   for a class in C++.  There are a few items that are worth mentioning though:

   </p>
<table border="0" cellpadding="5" cellspacing="0">

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(1)</font></td>
     <td align="left" valign="top">
      Chare classes inherit from parent classes which are auto-generated by the Charm++
      tools during compilation.  Also, there is nothing that forces the name of the
      mainchare to be "Main".  This is simply convention.  The main chare is specified
      in the ".ci" file using the <i>mainchare</i> keyword.
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(2)</font></td>
     <td align="left" valign="top">
      This is the entry point of the application.  This constructor is automatically
      called by the Charm++ Runtime System when the application starts.  The CkArgMsg
      message passed to it contains command line arguments that were specified by the
      user.
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(3)</font></td>
     <td align="left" valign="top">
      This is a constructor that is used for chare object migration (the Charm++
      Runtime System can dynamically migrate chare objects between processing elements).
      For now, just include this constructor but do not worry about what it does.
     </td>
    </tr>

   </table>

  
  
  
  <h3>The Source File <i>(main.C)</i>
</h3>
  
  <p class="BasicParagraph">
   The source file for a chare class in Charm++ is basically the same as it would be
   for a class in C++.

   </p>
<table border="0" cellpadding="5" cellspacing="0">

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(4)</font></td>
     <td align="left" valign="top">
      CkPrintf() is a special version of the printf() function provided by C/C++.  For
      the purpose of this example, the difference doesn't matter.  However, CkPrintf()
      is designed to re-route the output of all processing elements to a single point
      which can be viewed by the user.  Otherwise, it is the same as printf().
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(5)</font></td>
     <td align="left" valign="top">
      CkExit() is a special version of the exit() function provided by C/C++.  For
      Charm++ applications, this function <i>must</i> be called to cause the
      program to exit (unlike C/C++ where returning from main() will also cause the
      program to exit).  CkExit() does not return on the processing element that it
      was called on and causes all other processing elements being used by the
      application to also exit the application.
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(6)</font></td>
     <td align="left" valign="top">
      The "main.decl.h" and "main.def.h" files are auto-generated by the Charm++
      tools during the compilation process.  They contain code that is used to
      <i>hook</i> the application code to the Charm++ Runtime System, they declare
      parent classes for chare classes, and so on.  The "decl.h" file should be
      included at the beginning of the source file and the "def.h" file should be
      included at the very end of the source file.
     </td>
    </tr>

   </table>

  
  

  <h3>The Interface File <i>(main.ci)</i>
</h3>
  
  <p class="BasicParagraph">

   </p>
<table border="0" cellpadding="5" cellspacing="0">

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(7)</font></td>
     <td align="left" valign="top">
      This declares the interface module.  For the purpose of this example, the important
      thing to know is that the "main" keyword is used to name the generated files (the
      "main.decl.h" and "main.def.h" files).
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(8)</font></td>
     <td align="left" valign="top">
      This line declares the main chare for the application.  In this example, the
      "Main" class is declared as the main chare class.  The Charm++ Runtime System
      will create an instance of the Main chare class (execution of the program
      begins with the execution of this Main chare object's constructor).
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(9)</font></td>
     <td align="left" valign="top">
      This line declares one of the member functions (in this case, a constructor) of
      the Main chare class as an entry method.  This means that other chare objects and
      the Charm++ Runtime System can send a chare object of this type messages destined
      for this entry method (i.e. other chare objects in the global object space can
      invoke this entry method on a Main chare object).
     </td>
    </tr>

   </table>

  


  <h3>Makefile</h3>
  
  <p class="BasicParagraph">

   </p>
<table border="0" cellpadding="5" cellspacing="0">

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(10)</font></td>
     <td align="left" valign="top">
      The path to the root directory of an installation of the Charm++ distribution
      should be placed here.
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(11)</font></td>
     <td align="left" valign="top">
      Charmc is a tool specific to Charm++.  It serves as a <i>wrapper</i> for the
      native linker and compiler on a given system (along with providing some additional
      functionality).  This allows a programmer to write
      a Makefile that uses charmc as the compiler and then re-use the same Makefile
      on various platforms (making the Makefile itself portable regardless of the
      compilers used on the various systems).
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(12)</font></td>
     <td align="left" valign="top">
      In this case, charmc is being used as a linker.  There is only one programmer
      specified object file, however, the standard C/C++ libraries and the libraries
      containing the Charm++ Runtime System are also being linked into the final
      application at this point.  Additionally, another program called charmrun will
      be created in the same directory which will allow the user to launch their
      application on multiple processing elements at a time (or the user can just run
      their application directly, in this case using "./hello", which will cause it to
      only run on the local machine).
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(13)</font></td>
     <td align="left" valign="top">
      In this case, charmc is being used as a compiler.  Charmc will basically just
      call the native compiler on the system to create the object file from the
      source file.
     </td>
    </tr>

    <tr>
     <td align="center" valign="middle"><font class="generalComment">(14)</font></td>
     <td align="left" valign="top">
      In this case, charmc is being used to auto-generate the "main.decl.h" and
      "main.def.h" files.  These files contain the <i>hooks</i> needed to allow the
      application code and the Charm++ Runtime System to interoperate.
     </td>
    </tr>

   </table>

  

  
  <h3>Output of the Basic "Hello World" Program</h3>
  
  <p class="BasicParagraph">

   Below is the output of the basic "Hello World" example program.  The first line
   is the command used to launch the program.  Since this program only has a single
   chare object, executing it on more than a single processor using <i>charmrun</i> does
   not make any sense (the other processors will have no chare objects on them).
   The next example program will have multiple objects and demonstrate using charmrun
   to launch a Charm++ program.  The second line simply indicates to the user that
   the program is being executed on a single processor (i.e. charmrun was not used).
   The third line is the output from the CkPrintf() statement in Main::Main(CkArgMsg*).
   The fourth and final line is printed by the Charm++ Runtime System to indicate
   that the program has exited (only when the program is run in standalone mode).

   <!-- Figure -->
   </p>
<center>
   <table border="0" cellpadding="5" cellspacing="0">
    <tr>
     <td align="left" valign="middle">
      <div class="code">
       <code>
        $ ./hello<br>
        Charm++: standalone mode (not using charmrun)<br>
        Hello World!<br>
        Program finished.
       </code>
      </div>
     </td>
    </tr>
    <tr>
     <td colspan="2" align="center" valign="middle">
      <b>Figure:</b> Output of the Basic "Hello World" Program
     </td>
    </tr>
   </table>
   </center>

  

   </div>
 </div>
      
      <div id="footer">
	© 2020 
    	<a href="https://charm.cs.illinois.edu">Parallel Programming Lab</a>,
	<a href="https://cs.illinois.edu">Dept of Computer Science</a>,
	<a href="https://illinois.edu">University of Illinois</a>
      </div>
    </div>
    <script src="../assets/hover.js" type="text/javascript"></script>
  </body>
</html>
