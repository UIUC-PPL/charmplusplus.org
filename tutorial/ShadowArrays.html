<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta charset="utf-8">
    <title>Charm++: Tutorial</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<link href="/assets/charmwebsite.css" rel="stylesheet" type="text/css"/>
		<link href="http://fonts.googleapis.com/css?family=Puritan" rel="stylesheet" type="text/css"/>
		<link href="http://fonts.googleapis.com/css?family=Droid Sans" rel="stylesheet" type="text/css"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript">
		</script>
		<script src="/codemirror/lib/codemirror.js" type="text/javascript">
		</script>
		<script src="/codemirror/mode/clike/clike.js" type="text/javascript">
		</script>
		<script src="/codemirror/lib/util/runmode.js" type="text/javascript">
		</script>
		<link href="/codemirror/lib/codemirror.css" rel="stylesheet" type="text/css"/>
		<link href="/codemirror/theme/lesser-dark.css" rel="stylesheet" type="text/css"/>
		<script src="/assets/prettify.js" type="text/javascript">
		</script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<!-- for equations from LaTeX to appear correctly-->
		<script type="text/javascript" src="http://latex.codecogs.com/latexit.js"></script>
		
    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 4.7.5"> 
  </head>

  <body>
    <div class="container">
			
 <nav class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
	  <!-- Brand and toggle get grouped for better mobile display -->
		<div id="logo"><a href="/"><img class="img-responsive" src="../images/charm_logo.jpg"></a></div>

<!-- Charm++ Button textformatted placeholder for logo button
		<div class="navbar-header">
	    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
	    </button>
	    <a class="navbar-brand" href="/"><b>Charm++</b></a>
	  </div>
-->

	  <!-- Collect the nav links, forms, and other content for toggling -->
	  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	    <ul class="nav navbar-nav">
              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Explore<span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="/capabilities/">Capabilities</a></li>
		  <li><a href="/progmodel/">Programming Model</a></li>
		  <li><a href="/execmodel/">Execution Model</a></li>
		  <li><a href="/applications/">Applications</a></li>
		  <li><a href="http://charm.cs.illinois.edu/papers/">Publications</a></li>
		  <li><a href="/history/">History</a></li>
		</ul>
              </li>
              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Learn <span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="https://charm.readthedocs.io/en/latest/charm++/manual.html#installing-charm">Installation</a></li>
      		  <li><a href="/tutorial/">Tutorial</a></li>
						<li><a href="/exercises/">Exercises</a></li>
      		  <li><a href="/help/">Manual</a></li>
      		  <li><a href="/tools/">Tools</a></li>
      		  <li><a href="/othermedia/">Other Media</a></li>
		</ul>
              </li>

              <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Follow <span class="caret"></span></a>
		<ul class="dropdown-menu" role="menu">
		  <li><a href="https://github.com/UIUC-PPL/charm/commits/master">Recent Commits</a></li>
      	  <li><a href="https://github.com/UIUC-PPL/charm/issues">Issue Tracker</a></li>
      	  <li><a href="http://charm.cs.illinois.edu/autobuild/cur/">Nightly Tests</a></li>
      	  <li><a href="https://lists.cs.illinois.edu/lists/info/charm">Mailing Lists</a></li>
      	  <li><a href="http://charm.cs.illinois.edu/gerrit/#/admin/projects/">Other Repositories</a></li>
      	  <li><a href="http://ppl.cs.illinois.edu">PPL Website</a></li>
		</ul>
              </li>

              <li class="dropdown">
		<a href="/download/">Downloads</a>
              </li>

              <li class="dropdown">
		<a href="/miniApps/">Mini-Apps</a>
              </li>

	    </ul>
	  <form class="navbar-form navbar-right" role="search" method="get" action="http://www.google.com/search">
              <div class="form-group">
		<input type="hidden" name="sitesearch" value="charmplusplus.org"></input>
		<input type="text" class="form-control" name="q" placeholder="Search"></input>
              </div>
              <button type="submit" class="btn btn-default">Submit</button>
	    </form>
	  </div><!-- /.navbar-collapse -->
	</div><!-- /.container-fluid -->
      </nav>


 <div id="maincontainer">
   <div id="content">
     
  <link rel="stylesheet" type="text/css" href="TutorialStyle.css">
  
  <h1>Shadow Arrays (AKA: Bound Arrays)</h1>

  <p class="BasicParagraph">
   It may be useful to have corresponding elements of two or more chare arrays to be located on the
   same processor.  For example, if the corresponding elements of chare arrays <i>X</i> and <i>Y</i>
   frequently communicate with one another, it would be advantageous to have those elements,
   <i>X[i]</i> and <i>Y[i]</i>, on the same processor to reduce communication costs.  Shadow arrays
   in Charm++ are a way of accomplishing just this type of behavior.  When two or more arrays are
   <i>bound</i>, the Charm++ Runtime System ensures that the objects are always located on the same
   physical processor.
  </p>

  <!-- Figure -->
  <table class="StandardFigure" border=0 align=right>
   <tr><td align=left valign=middle bgColor=bbbbbb>
    <div style="{margin:5px;}">
     <code>
      <font class="codeComment">// Assumed variable declarations</font><br>
      int numElements = <font class="generalComment">...</font>;<br>
      <br>
      <font class="codeComment">// Creation of first array (standard process)</font><br>
      CProxy_myArrayClass1 myArray1 = CProxy_myArrayClass1::ckNew(<i>...parameters...</i> , numElements);<br>
      <br>
      <font class="codeComment">// Creation of the second array (bound to the first)</font><br>
      CkArrayOptions ckOptions(numElements);<br>
      opts.bindTo(myArray1);<br>
      CProxy_myArrayClass2 myArray2 = CProxy_myArrayClass2::ckNew(ckOptions);<br>
     </code>
    </div>
   </td></tr>
   <tr><td align=center valign=middle>
    <b>Figure 1:</b> Code to create two chare arrays, <i>myArray1</i> and <i>myArray2</i>, which are
    bound together.
   </td></tr>
  </table>

  <p class="BasicParagraph">
   Shadow (or bound) arrays create a relationship in terms of element mapping and load balancing between
   two or more arrays.  The idea is fairly straight forward.  First, a chare array is created in the
   standard manner.  Then, a second array is created as a shadow of the first array (or bound to the first
   array).  This is done through the <i>CkArrayOptions</i> parameter to the <i>ckNew</i> call which creates
   the second array.  Additional arrays can also be bound to this set of bound arrays in a similar manner.
  </p>

  <p class="BasicParagraph">
   There is no restriction to the type or number of chare elements in the arrays.  The bound arrays can
   be instances of the same chare array class or be different chare array classes.  Also, the arrays do not
   have to have the same number of elements.  For indexes where the other array doesn't have a corresponding
   element, the element that exists is free to move between processors arbitrarily.  The Charm++ Runtime
   System simply ensures that <i>when there are corresponding elements (that is, elements at
   corresponding indexes), in a set of bound arrays, the elements will be located on the same physical
   processor</i>.
  </p>

  <p class="BasicParagraph">
   Since the corresponding objects are always located on the same processor, the objects can take advantage
   of this in various ways.  For example, they can obtain local pointers to one another via a call to
   <i>ckLocal()</i> on the proxy for the element.  However, each time the objects migrate (i.e. the objects
   are unpacked via the <a href="PackUnPackRoutines.html">Pack-UnPack Routines</a>), the local pointer needs
   to be refreshed so it is a valid pointer on the new physical processor.
  </p>

  <p class="BasicParagraph">
   For more information on callbacks, please see
   <a href="http://charm.cs.uiuc.edu/manuals/html/charm++/3_8Advanced_Arrays.html#SECTION00038600000000000000">Section 3.8.6: Advanced Array Creation: Bound Arrays</a> of the
   <a href="http://charm.cs.uiuc.edu/manuals/html/charm++/manual.html">The Charm++ Programming Language Manual</a>
  </p>

   </div>
 </div>
      
      <div id="footer">
	&copy; 2020 
    	<a href="http://ppl.cs.illinois.edu">Parallel Programming Lab</a>,
	<a href="http://cs.illinois.edu">Dept of Computer Science</a>,
	<a href="http://illinois.edu">University of Illinois</a>
      </div>
    </div>
    <script src="/assets/hover.js" type="text/javascript"></script>
  </body>
</html>
